<mat-card appearance="outlined">

  <div class="form">

    <div class="form-buttons">

      <button *ngIf="EmptyList || activeNode" mat-raised-button class="save-button" color="primary"
        (click)="addNode()">جدید</button>

      <button *ngIf="activeNode" mat-raised-button class="warning-button" color="accent"
        (click)="editNode()">ویرایش</button>

      <button *ngIf="activeNode" mat-stroked-button class="close-button" color="warn" (click)="delete()">حذف</button>

      <button mat-raised-button class="close-button" color="warn" (click)="close()">بستن</button>

    </div>
  </div>

  <div class="form-body" *ngIf="showTree">

    <p *ngIf="EmptyList">درختی برای نمایش وجود ندارد</p>

    <mat-tree dir="rtl" [dataSource]="dataSource" [treeControl]="treeControl">

      <mat-tree-node dir="rtl" *matTreeNodeDef="let node" matTreeNodePadding>
        <mat-label [class.active-node]="activeNode == node.Id" (click)="clickNode(node)" (dblclick)="dblClickNode(node)"
          dir="rtl">{{node.name}}
        </mat-label>
      </mat-tree-node>

      <mat-tree-node dir="rtl" *matTreeNodeDef="let node;when: hasChild" matTreeNodePadding>
        <i matTreeNodeToggle *ngIf="hasChild"
          [ngClass]="treeControl.isExpanded(node) ? 'fa fa-angle-down' : 'fa fa-angle-left'"></i>
        <mat-label [class.active-node]="activeNode == node.Id" (click)="clickNode(node)" (dblclick)="dblClickNode(node)"
          [class.text-danger]="hasChild" dir="rtl" [class.last-child]="!hasChild">{{node.name}}</mat-label>
      </mat-tree-node>

    </mat-tree>
  </div>

</mat-card>

<mat-card appearance="outlined" *ngIf="showTab">
  <div class="form-buttons">
    <button mat-raised-button class="close-button" color="warn" (click)="closeTab()">بستن</button>
  </div>

  <mat-tab-group dir="rtl" (selectedTabChange)="tabChange($event.index)">

    <mat-tab dir="rtl" label="اطلاعات نود">
      <div class="mt-1">
        <cost-center-tree-form [CostCenterGroupCode]="CostCenterGroupCode" [parentId]="parentId" [ID]="nodeId"
          [formType]="formType" (done)="submited($event)" (closed)="closeTab()">
        </cost-center-tree-form>
      </div>
    </mat-tab>

    <mat-tab *ngIf="formType != 'Add'" dir="rtl" label="انتساب شعب بانک به مرکز هزینه">
      <div class="mt-1">
        <cost-center-bank *ngIf="showBank" [nodeId]="nodeId"></cost-center-bank>
      </div>
    </mat-tab>

    <mat-tab *ngIf="formType != 'Add'" dir="rtl" label="انتساب واحد سازمانی به مرکز هزینه">
      <div class="mt-1">
        <cost-center-unit *ngIf="showUnit" [nodeId]="nodeId"></cost-center-unit>
      </div>
    </mat-tab>

  </mat-tab-group>
</mat-card>